üõ†Ô∏è –û—Ç—á—ë—Ç –æ–± —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞

–ù–∞–∑–≤–∞–Ω–∏–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ Linux-—Å–µ—Ä–≤–µ—Ä–∞ –∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–î–∞—Ç–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞: 02.06.2025

–ê–≤—Ç–æ—Ä –æ—Ç—á—ë—Ç–∞: Ella Gubareva


üîç –†–µ–∑—é–º–µ (Summary)

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Å–±–æ—è –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –ø–æ –∞–¥—Ä–µ—Å—É 18.195.185.162 –ø–µ—Ä–µ—Å—Ç–∞–ª –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã. –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ —Å–∏—Å—Ç–µ–º–∞ —É–∫–∞–∑–∞–ª–∞ –Ω–∞ –ø—Ä–æ–±–ª–µ–º—É —Å —Ñ–∞–π–ª–æ–º LocalSettings.php.
–í —Ö–æ–¥–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –±—ã–ª–∞ –≤—ã—è–≤–ª–µ–Ω–∞ –æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞ ‚Äî –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∏—Å–∫–∞, –∏–∑-–∑–∞ —á–µ–≥–æ —Å–µ—Ä–≤–∏—Å httpd –Ω–µ –º–æ–≥ –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è. –¢–∞–∫–∂–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω –ø—É—Å—Ç–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª –∏ –æ—à–∏–±–∫–∞ –≤ IP-–∞–¥—Ä–µ—Å–µ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏. 
–ü–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –æ—á–∏—Å—Ç–∫–∏ –ª–æ–≥–æ–≤ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ CRON-–∑–∞–¥–∞—á–∏, –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–∞–±–æ—Ç–∞–ª–æ.


üìå –ü—Ä–∏—á–∏–Ω—ã –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞

–ü—É—Å—Ç–æ–π –∏–ª–∏ –ø–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω—ã–π —Ñ–∞–π–ª LocalSettings.php, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –¥–ª—è —Ä–∞–±–æ—Ç—ã MediaWiki.
–ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–Ω–∞—è —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ ‚Äî 100% –¥–∏—Å–∫–∞ –±—ã–ª–æ –∑–∞–Ω—è—Ç–æ.
–û—à–∏–±–∫–∞ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–º —Ñ–∞–π–ª–µ: –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —É–∫–∞–∑–∞–Ω–Ω—ã–π IP-–∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞.
–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è CRON-–∑–∞–¥–∞—á–∞, –∫–æ—Ç–æ—Ä–∞—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–ª–∞ —Å–∞–º–∞ —Å–µ–±—è.


üß© –•–æ–¥ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è: 

üîπ –®–∞–≥ 1. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É –∏ –ø–µ—Ä–≤–∏—á–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ SSH:
ssh ec2-user@18.195.185.162
–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã:
top           # –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä
service httpd status
–ü–æ–∏—Å–∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞:
find / -type f -name "LocalSettings.php" 2>/dev/null
–û–±–Ω–∞—Ä—É–∂–µ–Ω —Ñ–∞–π–ª /var/www/html/mediawiki/LocalSettings.php ‚Äî –ø—É—Å—Ç–æ–π.

üîπ –®–∞–≥ 2. –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞
–ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Å—Ç–∞:
df -h        # –ø–æ–∫–∞–∑–∞–ª–æ 100% –∑–∞–Ω—è—Ç–æ
free -h      # –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å –≤ –ø–æ—Ä—è–¥–∫–µ
–ü–æ–∏—Å–∫ –∫—Ä—É–ø–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤:
sudo find / -type f -size +50M -exec du -h {} + 2>/dev/null
–û–±–Ω–∞—Ä—É–∂–µ–Ω –æ–≥—Ä–æ–º–Ω—ã–π –ª–æ–≥-—Ñ–∞–π–ª:
/var/log/httpd/access_log_20250602 (7G)
–û—á–∏—Å—Ç–∫–∞ —Ñ–∞–π–ª–∞ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å:
echo "" > /var/log/httpd/access_log_20250602
–ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:
df -h        # –ø–æ—è–≤–∏–ª–æ—Å—å —Å–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ

üîπ –®–∞–≥ 3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
–ù–∞–π–¥–µ–Ω —Ñ–∞–π–ª —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –∏–º–µ–Ω–µ–º LoclSettings.php.
–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ:
nano /home/ec2-user/LocalSettings\ \(5\).php
–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Ñ–∞–π–ª–∞:
cp /var/www/html/mediawiki/LoclSettings.php /var/www/html/mediawiki/LocalSettings.php
–ü—Ä–æ–≤–µ—Ä–∫–∞:
nano /var/www/html/mediawiki/LocalSettings.php
–û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –æ—à–∏–±–∫–∞ IP-–∞–¥—Ä–µ—Å–∞:
–ë—ã–ª: https://18.153.51.162
–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞: https://18.195.185.162

üîπ –®–∞–≥ 4. –ó–∞–ø—É—Å–∫ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–∏—Å–∞
–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞:
service httpd restart
service httpd status
–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–∞–π—Ç–∞ (–ª–æ–∫–∞–ª—å–Ω–æ –∏–ª–∏ —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä):
curl http://localhost
–°–∞–π—Ç –∑–∞—Ä–∞–±–æ—Ç–∞–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

üîπ –®–∞–≥ 5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∏ CRON
–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞:
crontab -l
–£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è:
crontab -r
–°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞:
nano backup.sh
–°–æ–¥–µ—Ä–∂–∏–º–æ–µ backup.sh:
#!/bin/bash
LOG_DIR="/var/log"
LOG_FILE="access_log"
BACKUP_DIR="/path/to/backup"
MAX_BACKUPS=3
DATE=$(date +%F)
ARCHIVE="$BACKUP_DIR/$LOG_FILE-$DATE.tar.gz"

# –ê—Ä—Ö–∏–≤–∏—Ä—É–µ–º –ª–æ–≥-—Ñ–∞–π–ª
tar -czf "$ARCHIVE" "$LOG_DIR/$LOG_FILE"

# –£–¥–∞–ª—è–µ–º –∞—Ä—Ö–∏–≤—ã —Å—Ç–∞—Ä—à–µ 3 –¥–Ω–µ–π
find "$BACKUP_DIR" -type f -name "$LOG_FILE-*.tar.gz" -mtime +3 -exec rm {} \;

–í—ã–¥–∞—á–∞ –ø—Ä–∞–≤ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:
chmod 744 backup.sh

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏ –≤ CRON:
export EDITOR=nano
crontab -e
–î–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Ç—Ä–æ–∫–∞:
0 0 * * * /home/ec2-user/backup.sh


‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–í–µ–±-—Å–µ—Ä–≤–µ—Ä –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ.

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª LocalSettings.php –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –∏ –ø–µ—Ä–µ–ø–∏—Å–∞–Ω.

–û—Å–≤–æ–±–æ–∂–¥–µ–Ω–æ –º–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ, —É—Å—Ç—Ä–∞–Ω–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞.

–°–æ–∑–¥–∞–Ω —Ä–µ–∑–µ—Ä–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –∏ –¥–æ–±–∞–≤–ª–µ–Ω –≤ CRON.

–£—Å—Ç—Ä–∞–Ω–µ–Ω—ã –æ—à–∏–±–∫–∏ –≤ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–µ –∑–∞–¥–∞—á.


üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

–í–Ω–µ–¥—Ä–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã.

–ù–∞—Å—Ç—Ä–æ–∏—Ç—å logrotate –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ä–æ—Ç–∞—Ü–∏–∏ –ª–æ–≥–æ–≤ httpd, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è.

–ü—Ä–æ–≤–µ—Ä—è—Ç—å –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π —Å–µ—Ä–≤–µ—Ä–∞.

–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–∂–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω–æ.

–ò–∑–±–µ–≥–∞—Ç—å –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö –∏–ª–∏ –∫—Ä–∏–≤–æ –Ω–∞–∑–≤–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–º–µ–Ω–∞.

–ü—Ä–æ–≤–µ—Ä—è—Ç—å –∑–∞–¥–∞—á–∏ –≤ CRON –Ω–∞ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –∏ –∑–∞—Ü–∏–∫–ª–∏–≤–∞–Ω–∏–µ.
